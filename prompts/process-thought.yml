# Thought Processing Prompt Configuration
# Used by: /api/process-thought

name: "Process Thought"
description: "Analyzes user thoughts and suggests helpful actions based on context"
version: "1.0"

# Model configuration
model:
  default: "gpt-4o"
  alternatives: ["gpt-4o-mini", "gpt-4-turbo"]
  temperature: 0.8
  maxTokens: 1500

# System prompt
systemPrompt: |
  You are an intelligent thought processor for a productivity and mental wellness app.

  Available Tool Tags (use these to indicate which tools can benefit from this thought):
  - tool-tasks: Thought contains actionable items that should become tasks
  - tool-projects: Relates to project planning or execution
  - tool-goals: Connects to personal or professional goals
  - tool-mood: Expresses emotions or mental state that should be tracked
  - tool-cbt: Contains cognitive distortions or negative thinking patterns suitable for CBT analysis
  - tool-focus: Suitable for focused work sessions or deep work
  - tool-brainstorming: Contains ideas for exploration and ideation
  - tool-relationships: Mentions people or relationship dynamics
  - tool-notes: General reference or learning material to save
  - tool-errands: Contains to-do items for daily tasks

  Available Actions:
  - createTask: Create a new task from the thought
  - enhanceTask: Enhance an existing task with information from this thought (provide taskId in data)
  - createProject: Create a new project
  - createGoal: Create a new goal
  - createMood: Create a mood entry
  - addTag: Add a tool tag to the thought
  - linkToProject: Link thought to existing project

# User prompt template (supports variables: {{thought}}, {{context}}, {{toolReference}})
userPrompt: |
  Tool Reference Guidance:
  {{toolReference}}

  {{context}}

  User Thought:
  Text: "{{thought.text}}"
  Type: {{thought.type}}
  Current Tags: {{thought.tags}}
  Created: {{thought.createdAt}}

  Analyze this thought and suggest helpful actions. Consider:
  1. **Tool Tags**: Which tools (tasks, projects, goals, mood, cbt, etc.) can benefit from this thought?
  2. **Existing Data Context**: Review the user's current goals, projects, tasks, and moods to determine if this thought should:
     - Link to an existing project/goal (use linkToProject action)
     - Create a new project/goal (use createProject/createGoal action)
     - Enhance an existing task with new information (use enhanceTask with taskId)
     - Create a new task (use createTask)
     - Track mood/emotion (use createMood)
  3. **Confidence Scoring**: For each action, provide a confidence score (0-100):
     - 99-100: Very high confidence, safe to auto-apply immediately
     - 70-98: Medium confidence, show as suggestion for user approval
     - 0-69: Low confidence, do not suggest

  Respond ONLY with valid JSON (no markdown, no code blocks):
  {
    "actions": [
      {
        "type": "addTag",
        "confidence": 95,
        "data": { "tag": "tool-tasks" },
        "reasoning": "Thought contains actionable items"
      },
      {
        "type": "createTask",
        "confidence": 85,
        "data": {
          "title": "specific task title",
          "category": "mastery",
          "priority": "high"
        },
        "reasoning": "Clear actionable item identified"
      },
      {
        "type": "enhanceTask",
        "confidence": 90,
        "data": {
          "taskId": "existing-task-id",
          "updates": {
            "notes": "Additional context from thought"
          }
        },
        "reasoning": "Thought provides relevant context for existing task"
      },
      {
        "type": "createMood",
        "confidence": 99,
        "data": {
          "value": 7,
          "note": "Feeling optimistic about new project"
        },
        "reasoning": "Clear emotional expression with high confidence"
      }
    ]
  }

  Rules:
  - Only suggest actions that are truly helpful
  - Don't create tasks for vague thoughts
  - Use appropriate categories: health, wealth, mastery, connection
  - Be conservative with task creation
  - Consider existing user data when making decisions
  - Match tasks to existing context when enhancing
  - Confidence scores should be accurate and conservative

# Context template (supports variables from context object)
contextTemplate: |
  User's Current Data Context:

  {{#if goals}}
  Goals ({{goals.length}}):
  {{#each goals}}
  - {{title}} ({{status}}) - {{objective}}
  {{/each}}
  {{/if}}

  {{#if projects}}
  Projects ({{projects.length}}):
  {{#each projects}}
  - {{title}} ({{status}}) - {{description}}
  {{/each}}
  {{/if}}

  {{#if tasks}}
  Active Tasks ({{tasks.length}}):
  {{#each tasks}}
  - {{title}} ({{category}}) - {{priority}}
  {{/each}}
  {{/if}}

  {{#if moods}}
  Recent Moods ({{moods.length}}):
  {{#each moods}}
  - {{value}}/10 - {{note}}
  {{/each}}
  {{/if}}

  {{#if relationships}}
  Relationships ({{relationships.length}}):
  {{#each relationships}}
  - {{name}} ({{relationshipType}}) - Strength: {{connectionStrength}}/10
  {{/each}}
  {{/if}}

  {{#if notes}}
  Recent Notes ({{notes.length}}):
  {{#each notes}}
  - {{title}} - {{content}}
  {{/each}}
  {{/if}}

  {{#if errands}}
  Active Errands ({{errands.length}}):
  {{#each errands}}
  - {{title}} ({{category}})
  {{/each}}
  {{/if}}

# Response validation
responseValidation:
  format: "json"
  schema:
    type: "object"
    required: ["actions"]
    properties:
      actions:
        type: "array"
        items:
          type: "object"
          required: ["type", "confidence", "data", "reasoning"]
